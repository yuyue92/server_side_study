# å·¥ä½œæµä¸å®¡æ‰¹æµç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªåŸºäº React + Fastify + SQLite æ„å»ºçš„ä¼ä¸šçº§å·¥ä½œæµå®¡æ‰¹ç®¡ç†ç³»ç»Ÿã€‚

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **å·¥ä½œæµç®¡ç†**ï¼šé¢„ç½®è¯·å‡ã€æŠ¥é”€ã€é‡‡è´­ã€æ–‡æ¡£å››ç§å®¡æ‰¹æµç¨‹
- **ä»»åŠ¡å‘èµ·**ï¼šå‘˜å·¥å¯å‘èµ·å„ç±»å®¡æ‰¹ç”³è¯·
- **å¤šçº§å®¡æ‰¹**ï¼šæ”¯æŒå¤šè§’è‰²ã€å¤šæ­¥éª¤çš„å®¡æ‰¹é“¾
- **å®æ—¶çŠ¶æ€è·Ÿè¸ª**ï¼šæ¸…æ™°å±•ç¤ºä»»åŠ¡å½“å‰å®¡æ‰¹è¿›åº¦
- **æ“ä½œæ—¥å¿—**ï¼šå®Œæ•´è®°å½•æ¯ä¸ªä»»åŠ¡çš„æ“ä½œå†å²

### ç”¨æˆ·è§’è‰²
| è§’è‰² | æƒé™è¯´æ˜ |
|------|---------|
| employee | å‘˜å·¥ï¼Œå¯å‘èµ·å®¡æ‰¹ç”³è¯· |
| manager | ç»ç†ï¼Œå¯å®¡æ‰¹ä¸‹å±ç”³è¯· |
| hr | äººäº‹ï¼Œå¯å®¡æ‰¹è¯·å‡ç­‰ç”³è¯· |
| finance | è´¢åŠ¡ï¼Œå¯å®¡æ‰¹æŠ¥é”€ã€é‡‡è´­ç”³è¯· |
| admin | ç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æœ€é«˜æƒé™ |

### é¢„ç½®å®¡æ‰¹æµç¨‹
1. **è¯·å‡å®¡æ‰¹**ï¼šå‘˜å·¥æäº¤ â†’ ç»ç†å®¡æ‰¹ â†’ HRç¡®è®¤
2. **æŠ¥é”€å®¡æ‰¹**ï¼šå‘˜å·¥æäº¤ â†’ ç»ç†å®¡æ‰¹ â†’ è´¢åŠ¡å®¡æ ¸
3. **é‡‡è´­å®¡æ‰¹**ï¼šå‘˜å·¥æäº¤ â†’ ç»ç†å®¡æ‰¹ â†’ è´¢åŠ¡å®¡æ ¸ â†’ ç®¡ç†å±‚æ‰¹å‡†
4. **æ–‡æ¡£å®¡æ‰¹**ï¼šèµ·è‰æ–‡æ¡£ â†’ åˆå®¡ â†’ å¤å®¡

## ğŸ›  æŠ€æœ¯æ ˆ

### å‰ç«¯
- **React 18** - ç”¨æˆ·ç•Œé¢
- **React Router 6** - è·¯ç”±ç®¡ç†
- **Tailwind CSS 3** - æ ·å¼æ¡†æ¶
- **Lucide React** - å›¾æ ‡åº“
- **Vite** - æ„å»ºå·¥å…·

### åç«¯
- **Fastify** - é«˜æ€§èƒ½ Node.js æ¡†æ¶
- **better-sqlite3** - SQLite æ•°æ®åº“é©±åŠ¨
- **@fastify/cors** - è·¨åŸŸæ”¯æŒ

### æ•°æ®åº“
- **SQLite3** - è½»é‡çº§åµŒå…¥å¼æ•°æ®åº“

## ğŸ“ é¡¹ç›®ç»“æ„

```
workflow-system/
â”œâ”€â”€ backend/                 # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ server.js           # Fastify æœåŠ¡å™¨
â”‚   â”œâ”€â”€ db.js               # æ•°æ®åº“è¿æ¥
â”‚   â””â”€â”€ init-db.js          # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ src/                    # å‰ç«¯æºç 
â”‚   â”œâ”€â”€ components/         # å…¬å…±ç»„ä»¶
â”‚   â”‚   â””â”€â”€ Layout.jsx      # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ context/            # React Context
â”‚   â”‚   â””â”€â”€ AuthContext.jsx # ç”¨æˆ·è®¤è¯ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Login.jsx       # ç™»å½•é¡µ
â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx   # å·¥ä½œå°
â”‚   â”‚   â”œâ”€â”€ TaskList.jsx    # ä»»åŠ¡åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ TaskDetail.jsx  # ä»»åŠ¡è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ CreateTask.jsx  # å‘èµ·å®¡æ‰¹
â”‚   â”‚   â”œâ”€â”€ MyApprovals.jsx # å¾…æˆ‘å®¡æ‰¹
â”‚   â”‚   â””â”€â”€ WorkflowList.jsx# æµç¨‹ç®¡ç†
â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ api.js          # API å°è£…
â”‚   â”œâ”€â”€ App.jsx             # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ main.jsx            # æ¸²æŸ“å…¥å£
â”‚   â””â”€â”€ index.css           # å…¨å±€æ ·å¼
â”œâ”€â”€ public/                 # é™æ€èµ„æº
â”œâ”€â”€ package.json            # ä¾èµ–é…ç½®
â”œâ”€â”€ vite.config.js          # Vite é…ç½®
â”œâ”€â”€ tailwind.config.js      # Tailwind é…ç½®
â””â”€â”€ README.md               # è¯´æ˜æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. åˆå§‹åŒ–æ•°æ®åº“

```bash
npm run init-db
```

è¿™å°†åˆ›å»ºæ•°æ®åº“å¹¶æ’å…¥ç¤ºä¾‹æ•°æ®ï¼š
- 7ä¸ªæµ‹è¯•ç”¨æˆ·
- 4ä¸ªå·¥ä½œæµå®šä¹‰

### 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

å‰åç«¯å°†åŒæ—¶å¯åŠ¨ï¼š
- å‰ç«¯: http://localhost:3000
- åç«¯: http://localhost:3001

### 4. ç™»å½•ç³»ç»Ÿ

ä½¿ç”¨ä»¥ä¸‹ä»»æ„è´¦å·ç™»å½•ï¼ˆé»˜è®¤å¯†ç ï¼š123456ï¼‰ï¼š

| ç”¨æˆ·å | å§“å | è§’è‰² | éƒ¨é—¨ |
|--------|------|------|------|
| zhangsan | å¼ ä¸‰ | å‘˜å·¥ | æŠ€æœ¯éƒ¨ |
| lisi | æå›› | å‘˜å·¥ | å¸‚åœºéƒ¨ |
| wangwu | ç‹äº” | ç»ç† | æŠ€æœ¯éƒ¨ |
| zhaoliu | èµµå…­ | ç»ç† | å¸‚åœºéƒ¨ |
| sunqi | å­™ä¸ƒ | HR | äººäº‹éƒ¨ |
| zhouba | å‘¨å…« | è´¢åŠ¡ | è´¢åŠ¡éƒ¨ |
| admin | ç®¡ç†å‘˜ | ç®¡ç†å‘˜ | ç®¡ç†å±‚ |

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### ER å›¾

```
users (ç”¨æˆ·è¡¨)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ username (ç”¨æˆ·å)
â”œâ”€â”€ password (å¯†ç )
â”œâ”€â”€ name (å§“å)
â”œâ”€â”€ email (é‚®ç®±)
â”œâ”€â”€ role (è§’è‰²)
â”œâ”€â”€ department (éƒ¨é—¨)
â””â”€â”€ avatar (å¤´åƒ)

workflows (å·¥ä½œæµå®šä¹‰)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ name (æµç¨‹åç§°)
â”œâ”€â”€ description (æè¿°)
â”œâ”€â”€ type (ç±»å‹)
â”œâ”€â”€ steps (æ­¥éª¤JSON)
â”œâ”€â”€ is_active (æ˜¯å¦å¯ç”¨)
â””â”€â”€ created_by â†’ users.id

tasks (ä»»åŠ¡å®ä¾‹)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ workflow_id â†’ workflows.id
â”œâ”€â”€ title (æ ‡é¢˜)
â”œâ”€â”€ description (æè¿°)
â”œâ”€â”€ current_step (å½“å‰æ­¥éª¤)
â”œâ”€â”€ status (çŠ¶æ€)
â”œâ”€â”€ data (è¡¨å•æ•°æ®JSON)
â””â”€â”€ created_by â†’ users.id

approvals (å®¡æ‰¹è®°å½•)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ task_id â†’ tasks.id
â”œâ”€â”€ step_index (æ­¥éª¤ç´¢å¼•)
â”œâ”€â”€ step_name (æ­¥éª¤åç§°)
â”œâ”€â”€ approver_id â†’ users.id
â”œâ”€â”€ action (æ“ä½œ)
â””â”€â”€ comment (æ‰¹æ³¨)

logs (æ“ä½œæ—¥å¿—)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ task_id â†’ tasks.id
â”œâ”€â”€ user_id â†’ users.id
â”œâ”€â”€ action (æ“ä½œç±»å‹)
â””â”€â”€ details (è¯¦æƒ…)
```

## ğŸ”Œ API æ¥å£

### ç”¨æˆ·ç›¸å…³
- `GET /api/users` - è·å–æ‰€æœ‰ç”¨æˆ·
- `POST /api/login` - ç”¨æˆ·ç™»å½•
- `GET /api/users/role/:role` - æŒ‰è§’è‰²è·å–ç”¨æˆ·

### å·¥ä½œæµç›¸å…³
- `GET /api/workflows` - è·å–æ‰€æœ‰å·¥ä½œæµ
- `GET /api/workflows/:id` - è·å–å•ä¸ªå·¥ä½œæµ
- `POST /api/workflows` - åˆ›å»ºå·¥ä½œæµ

### ä»»åŠ¡ç›¸å…³
- `GET /api/tasks` - è·å–ä»»åŠ¡åˆ—è¡¨ï¼ˆæ”¯æŒç­›é€‰ï¼‰
- `GET /api/tasks/:id` - è·å–ä»»åŠ¡è¯¦æƒ…
- `POST /api/tasks` - åˆ›å»ºæ–°ä»»åŠ¡
- `POST /api/tasks/:id/approve` - å®¡æ‰¹ä»»åŠ¡
- `POST /api/tasks/:id/cancel` - å–æ¶ˆä»»åŠ¡

### ç»Ÿè®¡ç›¸å…³
- `GET /api/stats` - è·å–ç»Ÿè®¡æ•°æ®

## ğŸ¨ ç•Œé¢é¢„è§ˆ

ç³»ç»Ÿé‡‡ç”¨ç°ä»£åŒ–çš„ç»ç’ƒæ€è®¾è®¡é£æ ¼ï¼ŒåŒ…å«ï¼š
- å“åº”å¼å¸ƒå±€ï¼Œæ”¯æŒç§»åŠ¨ç«¯
- æ¸å˜è‰²ä¸»é¢˜
- æµç•…çš„åŠ¨ç”»æ•ˆæœ
- æ¸…æ™°çš„å®¡æ‰¹è¿›åº¦å±•ç¤º

## ğŸ“ ä½¿ç”¨æµç¨‹

1. **ç™»å½•ç³»ç»Ÿ**ï¼šé€‰æ‹©è§’è‰²å¯¹åº”çš„è´¦å·ç™»å½•
2. **å‘èµ·å®¡æ‰¹**ï¼šåœ¨"å‘èµ·å®¡æ‰¹"é¡µé¢é€‰æ‹©æµç¨‹ç±»å‹ï¼Œå¡«å†™è¡¨å•
3. **å®¡æ‰¹ä»»åŠ¡**ï¼šå®¡æ‰¹äººåœ¨"å¾…æˆ‘å®¡æ‰¹"é¡µé¢å¤„ç†å¾…åŠä»»åŠ¡
4. **è·Ÿè¸ªè¿›åº¦**ï¼šåœ¨"ä»»åŠ¡åˆ—è¡¨"æˆ–"å·¥ä½œå°"æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€

## ğŸ”§ æ‰©å±•å¼€å‘

### æ·»åŠ æ–°çš„å®¡æ‰¹æµç¨‹
1. åœ¨ `backend/init-db.js` ä¸­æ·»åŠ æ–°çš„å·¥ä½œæµå®šä¹‰
2. åœ¨ `src/pages/CreateTask.jsx` çš„ `formFields` ä¸­æ·»åŠ è¡¨å•å­—æ®µé…ç½®

### æ·»åŠ æ–°çš„ç”¨æˆ·è§’è‰²
1. ä¿®æ”¹æ•°æ®åº“ä¸­ users è¡¨çš„ role CHECK çº¦æŸ
2. æ›´æ–° `src/utils/api.js` ä¸­çš„ `getRoleText` å‡½æ•°

## ğŸ“„ è®¸å¯è¯

MIT License
